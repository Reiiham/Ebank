import{c as Re,d as Be,e as He,f as ze,g as Ge,h as Ye,i as Ke,j as Je,k as Ze,l as Qe,m as Xe,n as et,o as tt,p as nt}from"./chunk-R5MXFTL3.js";import{$a as Pe,$b as We,Ab as F,B as k,Ba as x,C as Oe,Cb as V,E as A,Ea as f,Fa as c,Ib as Ne,J as u,Jb as Le,K as g,Kb as De,Nb as me,Oa as ce,Ob as N,P as R,Pa as a,Qa as p,Qb as B,Ra as I,Rb as U,Sa as ne,Tb as H,Ua as M,Ub as j,Va as w,Vb as Q,Wa as O,Wb as X,Xb as W,Yb as pe,_b as je,a as D,ab as L,ac as ue,ba as l,bc as ge,cb as Te,cc as fe,db as J,dc as _e,eb as Ae,ec as ee,fa as T,fc as qe,ha as v,hc as Ue,ia as Ie,ic as te,j as E,jc as $e,la as _,oa as m,ob as ke,p as S,pb as de,qa as le,qb as Z,sa as h,sb as Fe,ta as Y,ua as K,va as r,vb as Ve,wa as i,wb as y,xa as b}from"./chunk-BNHO72UU.js";var ie=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=v({type:o,selectors:[["app-admin-layout"]],decls:19,vars:0,consts:[[1,"layout"],[1,"sidebar"],["routerLink","/admin/dashboard"],["routerLink","/admin/currencies"],["routerLink","/admin/settings"],["routerLink","/admin/create-employee"],[1,"content"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"aside",1)(2,"h2"),a(3,"Admin"),i(),r(4,"ul")(5,"li")(6,"a",2),a(7,"\u{1F3E0} Tableau de bord"),i()(),r(8,"li")(9,"a",3),a(10,"\u{1F4B1} Devises"),i()(),r(11,"li")(12,"a",4),a(13,"\u2699\uFE0F Param\xE8tres"),i()(),r(14,"li")(15,"a",5),a(16,"\u{1F464} Cr\xE9er un employ\xE9"),i()()()(),r(17,"main",6),b(18,"router-outlet"),i()())},dependencies:[y,me,Ne,De],styles:[".layout[_ngcontent-%COMP%]{display:flex}.sidebar[_ngcontent-%COMP%]{width:250px;background:#343a40;color:#fff;padding:20px;min-height:100vh}.sidebar[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:10px 0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;display:block;padding:10px;border-radius:4px}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#495057}.content[_ngcontent-%COMP%]{flex:1;padding:20px}"]})};var Ce=class o{constructor(t){this.http=t}apiUrl=`${N.apiUrl}/admin`;getHeaders(){let t=localStorage.getItem("token");if(!t)throw console.error("No token found"),new Error("No token found");return new F({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}handleError(t){return console.error("API Error:",t),E(()=>t)}transferFunds(t){return this.http.post(`${this.apiUrl}/funds`,t,{headers:this.getHeaders()}).pipe(S(this.handleError))}getAccountByRib(t){return this.http.get(`${this.apiUrl}/account/${t}`,{headers:this.getHeaders()}).pipe(S(this.handleError))}getAllAccounts(){return this.http.get(`${this.apiUrl}/accounts`,{headers:this.getHeaders()}).pipe(S(this.handleError))}static \u0275fac=function(e){return new(e||o)(A(V))};static \u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})};var st=(o,t)=>({"alert-success":o,"alert-error":t});function lt(o,t){if(o&1){let e=x();r(0,"div",30)(1,"span"),a(2),i(),r(3,"button",31),f("click",function(){u(e);let s=c();return g(s.closeAlert())}),a(4,"\xD7"),i()()}if(o&2){let e=c();m("ngClass",Pe(2,st,e.alertType==="success",e.alertType==="error")),l(2),p(e.alertMessage)}}function ct(o,t){if(o&1){let e=x();r(0,"div",34),f("click",function(){let s=u(e).$implicit,d=c(2);return g(d.selectAccount(s,"from"))}),r(1,"strong"),a(2),i(),r(3,"span"),a(4),i(),r(5,"span"),a(6),L(7,"currency"),i()()}if(o&2){let e=t.$implicit;l(2),p(e.rib),l(2),p(e.ownerName),l(2),p(Ae(7,3,e.balance,"MAD","symbol","1.2-2"))}}function dt(o,t){if(o&1&&(r(0,"div",32),_(1,ct,8,8,"div",33),i()),o&2){let e=c();l(),m("ngForOf",e.filteredFromAccounts)}}function mt(o,t){if(o&1&&(r(0,"div",35),a(1),i()),o&2){let e=c();l(),p(e.getFieldError("fromRib"))}}function pt(o,t){if(o&1&&(r(0,"div",36)(1,"div",37)(2,"h4"),a(3),i(),r(4,"p")(5,"strong"),a(6,"N\xB0:"),i(),a(7),i(),r(8,"p")(9,"strong"),a(10,"Type:"),i(),a(11),i(),r(12,"p")(13,"strong"),a(14,"Solde:"),i(),a(15),L(16,"currency"),i()()()),o&2){let e=c();l(3),p(e.fromAccountInfo.ownerName),l(4),I(" ",e.fromAccountInfo.accountNumber,""),l(4),I(" ",e.fromAccountInfo.type,""),l(4),I(" ",J(16,4,e.fromAccountInfo.balance,"MAD","1.2-2"),"")}}function ut(o,t){if(o&1){let e=x();r(0,"div",34),f("click",function(){let s=u(e).$implicit,d=c(2);return g(d.selectAccount(s,"to"))}),r(1,"strong"),a(2),i(),r(3,"span"),a(4),i(),r(5,"span"),a(6),L(7,"currency"),i()()}if(o&2){let e=t.$implicit;l(2),p(e.rib),l(2),p(e.ownerName),l(2),p(J(7,3,e.balance,"MAD","1.2-2"))}}function gt(o,t){if(o&1&&(r(0,"div",32),_(1,ut,8,7,"div",33),i()),o&2){let e=c();l(),m("ngForOf",e.filteredToAccounts)}}function ft(o,t){if(o&1&&(r(0,"div",35),a(1),i()),o&2){let e=c();l(),p(e.getFieldError("toRib"))}}function _t(o,t){if(o&1&&(r(0,"div",36)(1,"div",38)(2,"h4"),a(3),i(),r(4,"p")(5,"strong"),a(6,"N\xB0:"),i(),a(7),i(),r(8,"p")(9,"strong"),a(10,"Type:"),i(),a(11),i(),r(12,"p")(13,"strong"),a(14,"Solde:"),i(),a(15),L(16,"currency"),i()()()),o&2){let e=c();l(3),p(e.toAccountInfo.ownerName),l(4),I(" ",e.toAccountInfo.accountNumber,""),l(4),I(" ",e.toAccountInfo.type,""),l(4),I(" ",J(16,4,e.toAccountInfo.balance,"MAD","1.2-2"),"")}}function Ct(o,t){if(o&1&&(r(0,"div",35),a(1),i()),o&2){let e=c();l(),p(e.getFieldError("amount"))}}function xt(o,t){if(o&1&&(r(0,"p")(1,"span"),a(2,"Nouveau solde:"),i(),a(3),L(4,"currency"),i()),o&2){let e,n=c(2);l(3),I(" ",J(4,1,n.fromAccountInfo.balance-((e=n.transferForm.get("amount"))==null?null:e.value),"MAD","1.2-2")," ")}}function ht(o,t){if(o&1&&(r(0,"div",39)(1,"h3"),b(2,"i",40),a(3," R\xE9sum\xE9 du Virement"),i(),r(4,"p")(5,"span"),a(6,"De:"),i(),a(7),i(),r(8,"p")(9,"span"),a(10,"Vers:"),i(),a(11),i(),r(12,"p")(13,"span"),a(14,"Montant:"),i(),a(15),L(16,"currency"),i(),_(17,xt,5,5,"p",41),i()),o&2){let e,n,s=c();l(7),ne(" ",s.fromAccountInfo.ownerName," (",s.fromAccountInfo.rib,")"),l(4),ne(" ",s.toAccountInfo.ownerName," (",s.toAccountInfo.rib,")"),l(4),I(" ",J(16,6,(e=s.transferForm.get("amount"))==null?null:e.value,"MAD","1.2-2"),""),l(2),m("ngIf",s.fromAccountInfo.balance>=((n=s.transferForm.get("amount"))==null?null:n.value))}}function bt(o,t){o&1&&b(0,"i",42)}function yt(o,t){o&1&&b(0,"i",43)}var he=class o{constructor(t,e){this.fb=t;this.transferService=e;this.transferForm=this.fb.group({fromRib:["",[U.required,U.minLength(24)]],toRib:["",[U.required,U.minLength(24)]],amount:["",[U.required,U.min(.01)]]})}transferForm;accounts=[];filteredFromAccounts=[];filteredToAccounts=[];fromAccountInfo=null;toAccountInfo=null;isLoading=!1;showFromDropdown=!1;showToDropdown=!1;alertMessage="";alertType="success";showAlert=!1;ngOnInit(){this.loadAccounts(),this.setupFormListeners()}loadAccounts(){this.transferService.getAllAccounts().subscribe({next:t=>{this.accounts=t,this.filteredFromAccounts=[...t],this.filteredToAccounts=[...t]},error:t=>{console.error(t),this.showAlertMessage("Erreur lors du chargement des comptes","error")}})}setupFormListeners(){this.transferForm.get("fromRib")?.valueChanges.subscribe(t=>{this.filteredFromAccounts=t&&t.length>=3?this.accounts.filter(e=>e.rib.toLowerCase().includes(t.toLowerCase())||e.ownerName.toLowerCase().includes(t.toLowerCase())):[...this.accounts],this.showFromDropdown=!!(t&&this.filteredFromAccounts.length>0),t?.length>=24?this.getAccountInfo(t,"from"):this.fromAccountInfo=null}),this.transferForm.get("toRib")?.valueChanges.subscribe(t=>{this.filteredToAccounts=t&&t.length>=3?this.accounts.filter(e=>e.rib.toLowerCase().includes(t.toLowerCase())||e.ownerName.toLowerCase().includes(t.toLowerCase())):[...this.accounts],this.showToDropdown=!!(t&&this.filteredToAccounts.length>0),t?.length>=24?this.getAccountInfo(t,"to"):this.toAccountInfo=null})}selectAccount(t,e){e==="from"?(this.transferForm.patchValue({fromRib:t.rib}),this.fromAccountInfo=t,this.showFromDropdown=!1):(this.transferForm.patchValue({toRib:t.rib}),this.toAccountInfo=t,this.showToDropdown=!1)}getAccountInfo(t,e){this.transferService.getAccountByRib(t).subscribe({next:n=>{if(n.found){let s={rib:t,accountNumber:n.accountNumber,balance:n.balance,type:n.type,ownerName:n.ownerName};e==="from"?this.fromAccountInfo=s:this.toAccountInfo=s}else e==="from"?this.fromAccountInfo=null:this.toAccountInfo=null},error:n=>console.error("getAccountInfo error",n)})}onSubmit(){if(this.transferForm.invalid){this.markFormGroupTouched();return}this.isLoading=!0;let t=this.transferForm.value;this.transferService.transferFunds(t).subscribe({next:e=>{this.isLoading=!1,this.showAlertMessage(e.message,e.success?"success":"error"),e.success&&(this.transferForm.reset(),this.fromAccountInfo=null,this.toAccountInfo=null,this.loadAccounts())},error:e=>{this.isLoading=!1,console.error("Transfer error",e),this.showAlertMessage("Erreur lors du virement","error")}})}markFormGroupTouched(){Object.values(this.transferForm.controls).forEach(t=>t.markAsTouched())}showAlertMessage(t,e){this.alertMessage=t,this.alertType=e,this.showAlert=!0,setTimeout(()=>this.showAlert=!1,5e3)}closeAlert(){this.showAlert=!1}isFieldInvalid(t){let e=this.transferForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}hideDropdownWithDelay(t){setTimeout(()=>{t==="from"?this.showFromDropdown=!1:this.showToDropdown=!1},200)}getFieldError(t){let e=this.transferForm.get(t);return e?.errors?e.errors.required?"Champ requis.":e.errors.minlength?`Longueur min: ${e.errors.minlength.requiredLength}`:e.errors.min?"Le montant doit \xEAtre \u2265 0.01":"Champ invalide.":""}setTimeout=setTimeout;static \u0275fac=function(e){return new(e||o)(T(Ue),T(Ce))};static \u0275cmp=v({type:o,selectors:[["app-transfer"]],decls:53,vars:21,consts:[[1,"transfer-container"],[1,"card"],[1,"card-header"],[1,"fas","fa-exchange-alt"],["class","alert",3,"ngClass",4,"ngIf"],[1,"transfer-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"fas","fa-arrow-up"],[1,"form-group"],["for","fromRib"],[1,"input-container"],["id","fromRib","type","text","formControlName","fromRib","maxlength","24","placeholder","Entrez le RIB",3,"focus","blur"],["class","dropdown",4,"ngIf"],["class","error-message",4,"ngIf"],["class","account-display",4,"ngIf"],[1,"fas","fa-arrow-down"],["for","toRib"],["id","toRib","type","text","formControlName","toRib","maxlength","24","placeholder","Entrez le RIB",3,"focus","blur"],[1,"fas","fa-euro-sign"],["for","amount"],[1,"amount-input"],["id","amount","type","number","formControlName","amount","step","0.01","min","0.01","placeholder","0.00"],[1,"currency"],["class","transfer-summary",4,"ngIf"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],["class","fas fa-paper-plane",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-undo"],[1,"alert",3,"ngClass"],["type","button",1,"alert-close",3,"click"],[1,"dropdown"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"],[1,"error-message"],[1,"account-display"],[1,"account-card","from-account"],[1,"account-card","to-account"],[1,"transfer-summary"],[1,"fas","fa-receipt"],[4,"ngIf"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-paper-plane"]],template:function(e,n){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),b(4,"i",3),a(5," Virement entre Comptes"),i()(),_(6,lt,5,5,"div",4),r(7,"form",5),f("ngSubmit",function(){return n.onSubmit()}),r(8,"div",6)(9,"h3"),b(10,"i",7),a(11," Compte Source"),i(),r(12,"div",8)(13,"label",9),a(14,"RIB source *"),i(),r(15,"div",10)(16,"input",11),f("focus",function(){return n.showFromDropdown=!0})("blur",function(){return n.hideDropdownWithDelay("from")}),i(),_(17,dt,2,1,"div",12),i(),_(18,mt,2,1,"div",13),i(),_(19,pt,17,8,"div",14),i(),r(20,"div",6)(21,"h3"),b(22,"i",15),a(23," Compte Destinataire"),i(),r(24,"div",8)(25,"label",16),a(26,"RIB destinataire *"),i(),r(27,"div",10)(28,"input",17),f("focus",function(){return n.showToDropdown=!0})("blur",function(){return n.hideDropdownWithDelay("to")}),i(),_(29,gt,2,1,"div",12),i(),_(30,ft,2,1,"div",13),i(),_(31,_t,17,8,"div",14),i(),r(32,"div",6)(33,"h3"),b(34,"i",18),a(35," Montant"),i(),r(36,"div",8)(37,"label",19),a(38,"Montant \xE0 transf\xE9rer *"),i(),r(39,"div",20),b(40,"input",21),r(41,"span",22),a(42,"\u20AC"),i()(),_(43,Ct,2,1,"div",13),i()(),_(44,ht,18,10,"div",23),r(45,"div",24)(46,"button",25),_(47,bt,1,0,"i",26)(48,yt,1,0,"i",27),a(49),i(),r(50,"button",28),f("click",function(){return n.transferForm.reset(),n.fromAccountInfo=null,n.toAccountInfo=null}),b(51,"i",29),a(52," R\xE9initialiser "),i()()()()()),e&2){let s;l(6),m("ngIf",n.showAlert),l(),m("formGroup",n.transferForm),l(9),le("error",n.isFieldInvalid("fromRib")),l(),m("ngIf",n.showFromDropdown&&n.filteredFromAccounts.length),l(),m("ngIf",n.isFieldInvalid("fromRib")),l(),m("ngIf",n.fromAccountInfo),l(9),le("error",n.isFieldInvalid("toRib")),l(),m("ngIf",n.showToDropdown&&n.filteredToAccounts.length),l(),m("ngIf",n.isFieldInvalid("toRib")),l(),m("ngIf",n.toAccountInfo),l(9),le("error",n.isFieldInvalid("amount")),l(3),m("ngIf",n.isFieldInvalid("amount")),l(),m("ngIf",n.fromAccountInfo&&n.toAccountInfo&&((s=n.transferForm.get("amount"))==null?null:s.value)),l(2),m("disabled",n.transferForm.invalid||n.isLoading),l(),m("ngIf",n.isLoading),l(),m("ngIf",!n.isLoading),l(),I(" ",n.isLoading?"Traitement...":"Effectuer le Virement"," "),l(),m("disabled",n.isLoading)}},dependencies:[$e,W,B,pe,H,j,qe,_e,je,We,y,ke,de,Z,Ve],styles:[".transfer-container[_ngcontent-%COMP%]{max-width:800px;margin:20px auto;padding:20px}.card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 4px 20px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:30px;text-align:center}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 10px;font-size:28px;font-weight:600}.card-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;opacity:.9;font-size:16px}.transfer-form[_ngcontent-%COMP%]{padding:30px}.form-section[_ngcontent-%COMP%]{margin-bottom:35px;padding-bottom:25px;border-bottom:1px solid #e0e0e0}.form-section[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;margin-bottom:20px;font-size:20px;font-weight:600}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;color:#667eea}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:#555}.input-container[_ngcontent-%COMP%]{position:relative}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e0e0e0;border-radius:8px;font-size:16px;transition:border-color .3s ease;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:#e74c3c}.amount-input[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%}.amount-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:40px}.currency[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);color:#666;font-weight:600}.dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 4px 20px #0000001a;max-height:200px;overflow-y:auto;z-index:1000}.dropdown-item[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer;border-bottom:1px solid #f0f0f0;transition:background-color .2s ease}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f8f9ff}.dropdown-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.account-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.account-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333;font-size:14px}.owner-name[_ngcontent-%COMP%]{color:#666;font-size:13px}.balance[_ngcontent-%COMP%]{color:#27ae60;font-weight:600;font-size:13px}.account-display[_ngcontent-%COMP%]{margin-top:15px}.account-card[_ngcontent-%COMP%]{background:#f8f9ff;border:2px solid #e6e9ff;border-radius:8px;padding:20px;transition:all .3s ease}.account-card.from-account[_ngcontent-%COMP%]{border-left:4px solid #e74c3c}.account-card.to-account[_ngcontent-%COMP%]{border-left:4px solid #27ae60}.account-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#333;font-size:18px}.account-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;color:#666;font-size:14px}.account-card[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%]{color:#27ae60;font-weight:600;font-size:16px}.transfer-summary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9ff,#e6f3ff);border:2px solid #667eea;border-radius:12px;padding:25px;margin-bottom:30px}.transfer-summary[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#667eea;margin-bottom:20px;font-size:20px}.summary-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid rgba(102,126,234,.2)}.summary-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.summary-row.total[_ngcontent-%COMP%]{font-weight:600;font-size:18px;color:#333;padding-top:15px;margin-top:10px;border-top:2px solid #667eea;border-bottom:none}.summary-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{color:#666;font-weight:500}.summary-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#333;font-weight:600}.form-actions[_ngcontent-%COMP%]{display:flex;gap:15px;justify-content:center;margin-top:30px;flex-wrap:wrap}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;text-decoration:none;min-width:180px;justify-content:center}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 4px 15px #667eea4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 25px #667eea66}.btn-secondary[_ngcontent-%COMP%]{background:#f8f9fa;color:#666;border:2px solid #e0e0e0}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#e9ecef;border-color:#ccc}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:14px;margin-top:5px;font-weight:500}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:15px 20px;margin:20px 30px;border-radius:8px;font-weight:500}.alert-success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.alert-error[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.alert-message[_ngcontent-%COMP%]{flex:1}.alert-close[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;font-weight:700;cursor:pointer;color:inherit;opacity:.7;padding:0;margin-left:15px}.alert-close[_ngcontent-%COMP%]:hover{opacity:1}.fa-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.transfer-container[_ngcontent-%COMP%]{margin:10px;padding:10px}.card-header[_ngcontent-%COMP%]{padding:20px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px}.transfer-form[_ngcontent-%COMP%]{padding:20px}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}.summary-row[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.summary-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{align-self:flex-end}}"]})};var be=class o{constructor(t,e){this.http=t;this.authService=e}apiUrl=`${N.apiUrl}/admin`;getStats(){let t=this.authService.isLoggedIn()?localStorage.getItem("token"):null;if(!t)throw console.error("No token available for stats request"),new Error("Authentication required");let e=new F({Authorization:`Bearer ${t}`,"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}/dashboard`,{headers:e})}static \u0275fac=function(e){return new(e||o)(A(V),A(He))};static \u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})};function vt(o,t){o&1&&(r(0,"div",2),a(1,"Chargement..."),i())}function Et(o,t){if(o&1&&(r(0,"div",3),a(1),i()),o&2){let e=c();l(),p(e.error)}}function Mt(o,t){if(o&1&&(r(0,"div",4)(1,"div",5)(2,"h3"),a(3,"Devises"),i(),r(4,"p"),a(5),i()(),r(6,"div",5)(7,"h3"),a(8,"Param\xE8tres"),i(),r(9,"p"),a(10),i()(),r(11,"div",5)(12,"h3"),a(13,"Derni\xE8re mise \xE0 jour"),i(),r(14,"p"),a(15),L(16,"date"),i()()()),o&2){let e,n,s=c();l(5),p((e=s.stats==null?null:s.stats.totalCurrencies)!==null&&e!==void 0?e:"N/A"),l(5),p((n=s.stats==null?null:s.stats.totalSettings)!==null&&n!==void 0?n:"N/A"),l(5),p(s.stats?Te(16,3,s.stats.lastUpdate,"short"):"N/A")}}var re=class o{constructor(t){this.dashboardService=t}stats=null;loading=!0;error=null;ngOnInit(){this.loadStats()}loadStats(){this.loading=!0,this.error=null,this.dashboardService.getStats().subscribe({next:t=>{this.stats=t,this.loading=!1},error:t=>{this.error=t.message,this.loading=!1,console.error("Erreur lors du chargement des statistiques:",t)}})}static \u0275fac=function(e){return new(e||o)(T(be))};static \u0275cmp=v({type:o,selectors:[["app-admin-dashboard"]],decls:7,vars:3,consts:[[1,"dashboard-container"],[1,"dashboard-title"],[1,"loading"],[1,"error"],[1,"dashboard-grid"],[1,"dashboard-card"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2",1),a(2,"Tableau de bord Administrateur"),i(),_(3,vt,2,0,"div",2)(4,Et,2,1,"div",3)(5,Mt,17,6,"div",4),b(6,"app-transfer"),i()),e&2&&(l(3),h(n.loading?3:-1),l(),h(n.error?4:-1),l(),h(!n.loading&&!n.error?5:-1))},dependencies:[y,Fe,he],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px}.dashboard-title[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:20px}.chart-container[_ngcontent-%COMP%]{max-width:400px}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{padding:15px;border-radius:4px}.loading[_ngcontent-%COMP%]{background-color:#e0e0e0}.error[_ngcontent-%COMP%]{background-color:#ffe6e6;color:#d32f2f}"]})};var it=[{code:"USD",name:"United States Dollar"},{code:"EUR",name:"Euro"},{code:"JPY",name:"Japanese Yen"},{code:"GBP",name:"British Pound"},{code:"AUD",name:"Australian Dollar"},{code:"CAD",name:"Canadian Dollar"},{code:"CHF",name:"Swiss Franc"},{code:"CNY",name:"Chinese Yuan"},{code:"SEK",name:"Swedish Krona"},{code:"NZD",name:"New Zealand Dollar"}];function wt(o,t){if(o&1&&(r(0,"option",12),a(1),i()),o&2){let e=t.$implicit;m("value",e.code),l(),ne(" ",e.name," (",e.code,") ")}}function Ot(o,t){if(o&1){let e=x();r(0,"div")(1,"label",8),a(2,"Devise :"),i(),r(3,"select",9),O("ngModelChange",function(s){u(e);let d=c();return w(d.currency.codeISO,s)||(d.currency.codeISO=s),g(s)}),f("change",function(s){u(e);let d=c();return g(d.onSelectCurrency(s))}),r(4,"option",10),a(5,"-- Choisir une devise --"),i(),_(6,wt,2,3,"option",11),i()()}if(o&2){let e=c();l(3),M("ngModel",e.currency.codeISO),l(3),m("ngForOf",e.currencyList)}}function It(o,t){if(o&1){let e=x();r(0,"div")(1,"label"),a(2,"Nom :"),i(),b(3,"input",13),r(4,"label"),a(5,"Code ISO :"),i(),b(6,"input",13),r(7,"label",14),a(8,"Taux :"),i(),r(9,"input",15),O("ngModelChange",function(s){u(e);let d=c();return w(d.currency.exchangeRate,s)||(d.currency.exchangeRate=s),g(s)}),i()()}if(o&2){let e=c();l(3),m("value",e.currency.name),l(3),m("value",e.currency.codeISO),l(3),M("ngModel",e.currency.exchangeRate)}}function Pt(o,t){if(o&1){let e=x();r(0,"button",16),f("click",function(){u(e);let s=c();return g(s.onDelete())}),a(1,"Supprimer"),i()}}var z=class o{currencyList=it;formTitle="";currency;save=new R;cancel=new R;delete=new R;onSelectCurrency(t){let e=t.target.value,n=this.currencyList.find(s=>s.code===e);n&&(this.currency.codeISO=n.code,this.currency.name=n.name)}onSubmit(){this.save.emit(D({},this.currency))}onCancel(){this.cancel.emit()}onDelete(){this.currency.id&&this.delete.emit(this.currency.id)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=v({type:o,selectors:[["app-currency-form"]],inputs:{formTitle:"formTitle",currency:"currency"},outputs:{save:"save",cancel:"cancel",delete:"delete"},decls:13,vars:5,consts:[["form","ngForm"],[1,"currency-form"],[3,"ngSubmit"],[4,"ngIf"],[1,"buttons"],["type","submit",3,"disabled"],["type","button",3,"click"],["type","button",1,"btn-delete"],["for","currencySelect"],["id","currencySelect","name","currencySelect","required","",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","text","readonly","",3,"value"],["for","exchangeRate"],["type","number","id","exchangeRate","name","exchangeRate","required","","min","0","step","0.01",3,"ngModelChange","ngModel"],["type","button",1,"btn-delete",3,"click"]],template:function(e,n){if(e&1){let s=x();r(0,"div",1)(1,"h3"),a(2),i(),r(3,"form",2,0),f("ngSubmit",function(){return u(s),g(n.onSubmit())}),_(5,Ot,7,2,"div",3)(6,It,10,3,"div",3),r(7,"div",4)(8,"button",5),a(9,"Enregistrer"),i(),r(10,"button",6),f("click",function(){return u(s),g(n.onCancel())}),a(11,"Annuler"),i(),_(12,Pt,2,0,"button",7),i()()()}if(e&2){let s=ce(4);l(2),p(n.formTitle),l(3),m("ngIf",!n.currency.id),l(),m("ngIf",n.currency.id),l(2),m("disabled",!s.valid),l(4),h(n.currency.id?12:-1)}},dependencies:[y,de,Z,te,W,ge,fe,B,pe,ue,H,j,ee,_e,X,Q],styles:[".currency-form[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 10px #0000001a;margin-top:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.btn-save[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;padding:8px 16px;border:none;border-radius:4px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;padding:8px 16px;border:none;border-radius:4px;cursor:pointer}"]})};var ye=class o{constructor(t){this.http=t}apiUrl=`${N.apiUrl}/admin/currencies`;getHeaders(){let t=localStorage.getItem("token");if(!t)throw console.error("No token found"),new Error("No token found");return new F({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}getAllCurrencies(){return this.http.get(this.apiUrl,{headers:this.getHeaders()}).pipe(S(t=>(console.error("Error fetching currencies:",t),E(()=>new Error("Failed to fetch currencies: "+(t.error?.message||t.message))))))}addCurrency(t){return this.http.post(this.apiUrl,t,{headers:this.getHeaders()}).pipe(S(e=>(console.error("Error adding currency:",e),E(()=>new Error("Failed to add currency: "+(e.error?.message||e.message))))))}updateCurrency(t,e){return this.http.put(`${this.apiUrl}/${t}`,e,{headers:this.getHeaders()}).pipe(S(n=>(console.error("Error updating currency:",n),E(()=>new Error("Failed to update currency: "+(n.error?.message||n.message))))))}deleteCurrency(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getHeaders()}).pipe(S(e=>(console.error("Error deleting currency:",e),E(()=>new Error("Failed to delete currency: "+(e.error?.message||e.message))))))}static \u0275fac=function(e){return new(e||o)(A(V))};static \u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})};var At=(o,t)=>t.id;function kt(o,t){if(o&1&&(r(0,"div",1),a(1),i()),o&2){let e=c();l(),p(e.error)}}function Ft(o,t){o&1&&(r(0,"div",2),a(1,"Chargement..."),i())}function Vt(o,t){if(o&1){let e=x();r(0,"app-currency-form",6),f("save",function(s){u(e);let d=c();return g(d.saveEdited(s))})("cancel",function(){u(e);let s=c();return g(s.cancelEdit())})("delete",function(s){u(e);let d=c();return g(d.deleteCurrency(s))}),i()}if(o&2){let e=c();m("formTitle",e.selectedCurrency.id?"Modifier la devise":"Ajouter une devise")("currency",e.selectedCurrency)}}function Nt(o,t){if(o&1){let e=x();r(0,"tr")(1,"td"),a(2),i(),r(3,"td"),a(4),i(),r(5,"td"),a(6),i(),r(7,"td")(8,"button",7),f("click",function(){let s=u(e).$implicit,d=c(2);return g(d.edit(s))}),a(9,"Modifier"),i(),r(10,"button",8),f("click",function(){let s,d=u(e).$implicit,C=c(2);return g(C.deleteCurrency((s=d.id)!==null&&s!==void 0?s:-1))}),a(11,"Supprimer"),i()()()}if(o&2){let e=t.$implicit;l(2),p(e.name),l(2),p(e.codeISO),l(2),p(e.exchangeRate),l(4),m("disabled",!e.id)}}function Lt(o,t){if(o&1&&(r(0,"table")(1,"thead")(2,"tr")(3,"th"),a(4,"Nom"),i(),r(5,"th"),a(6,"Code ISO"),i(),r(7,"th"),a(8,"Taux"),i(),r(9,"th"),a(10,"Action"),i()()(),r(11,"tbody"),Y(12,Nt,12,4,"tr",null,At),i()()),o&2){let e=c();l(12),K(e.currencies)}}function Dt(o,t){o&1&&(r(0,"p"),a(1,"Aucune devise disponible."),i())}var oe=class o{constructor(t){this.currencyService=t}currencies=[];selectedCurrency=null;loading=!1;error=null;ngOnInit(){this.loadCurrencies()}loadCurrencies(){this.loading=!0,this.error=null,this.currencyService.getAllCurrencies().subscribe({next:t=>{this.currencies=t,this.loading=!1},error:t=>{this.error=`Erreur lors du chargement des devises: ${t.message||"Erreur inconnue"}`,this.loading=!1,console.error("Error loading currencies:",t)}})}addNewCurrency(){this.selectedCurrency={name:"",codeISO:"",exchangeRate:1}}edit(t){this.selectedCurrency=D({},t)}saveEdited(t){this.error=null,t.id?this.currencyService.updateCurrency(t.id,t).subscribe({next:e=>{let n=this.currencies.findIndex(s=>s.id===e.id);n!==-1&&(this.currencies[n]=e),this.selectedCurrency=null},error:e=>{this.error=`Erreur lors de la mise \xE0 jour de la devise: ${e.message||"Erreur inconnue"}`,console.error("Error updating currency:",e)}}):this.currencyService.addCurrency(t).subscribe({next:e=>{this.currencies.push(e),this.selectedCurrency=null},error:e=>{this.error=`Erreur lors de l'ajout de la devise: ${e.message||"Erreur inconnue"}`,console.error("Error adding currency:",e)}})}cancelEdit(){this.selectedCurrency=null}deleteCurrency(t){if(t==null){console.warn("Cannot delete currency: ID is undefined or null");return}confirm("\xCAtes-vous s\xFBr de vouloir supprimer cette devise ?")&&this.currencyService.deleteCurrency(t).subscribe({next:()=>{this.currencies=this.currencies.filter(e=>e.id!==t),this.selectedCurrency?.id===t&&(this.selectedCurrency=null)},error:e=>{this.error=`Erreur lors de la suppression de la devise: ${e.message||"Erreur inconnue"}`,console.error("Error deleting currency:",e)}})}static \u0275fac=function(e){return new(e||o)(T(ye))};static \u0275cmp=v({type:o,selectors:[["app-currency-list"]],decls:12,vars:4,consts:[[1,"currency-list"],[1,"error-message"],[1,"loading"],[1,"btn-add",3,"click"],[3,"formTitle","currency"],[1,"btn-refresh",3,"click"],[3,"save","cancel","delete","formTitle","currency"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click","disabled"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Liste des devises"),i(),_(3,kt,2,1,"div",1)(4,Ft,2,0,"div",2),r(5,"button",3),f("click",function(){return n.addNewCurrency()}),a(6,"+ Ajouter une devise"),i(),_(7,Vt,1,2,"app-currency-form",4)(8,Lt,14,0,"table")(9,Dt,2,0,"p"),r(10,"button",5),f("click",function(){return n.loadCurrencies()}),a(11,"Rafra\xEEchir"),i()()),e&2&&(l(3),h(n.error?3:-1),l(),h(n.loading?4:-1),l(3),h(n.selectedCurrency?7:-1),l(),h(n.currencies.length>0?8:9))},dependencies:[y,z],styles:[".currency-list[_ngcontent-%COMP%]{padding:20px}.error-message[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828;padding:10px;border-radius:4px;margin-bottom:10px}button[_ngcontent-%COMP%]{padding:8px 16px;margin:5px;border:none;border-radius:4px;cursor:pointer}.btn-add[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.btn-edit[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-refresh[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:10px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#f4f4f4}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}"]})};function Rt(o,t){if(o&1){let e=x();r(0,"button",21),f("click",function(){u(e);let s=c();return g(s.onDelete())}),a(1,"Supprimer"),i()}}var G=class o{setting;save=new R;cancel=new R;delete=new R;get formTitle(){return this.setting.id?"Modifier le param\xE8tre":"Ajouter un param\xE8tre"}onSubmit(){this.save.emit(D({},this.setting))}onCancel(){this.cancel.emit()}onDelete(){this.setting.id&&this.delete.emit(this.setting.id)}isValueDate(){return typeof this.setting.value=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(this.setting.value)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=v({type:o,selectors:[["app-settings-edit-form"]],inputs:{setting:"setting"},outputs:{save:"save",cancel:"cancel",delete:"delete"},decls:37,vars:10,consts:[["settingForm","ngForm"],[1,"settings-edit-form"],[3,"ngSubmit"],[1,"form-group"],["for","key"],["id","key","name","key","required","",1,"form-control",3,"ngModelChange","ngModel","disabled"],["for","label"],["id","label","name","label",1,"form-control",3,"ngModelChange","ngModel"],["for","description"],["id","description","name","description",1,"form-control",3,"ngModelChange","ngModel"],["for","category"],["id","category","name","category",1,"form-control",3,"ngModelChange","ngModel"],["value","finance"],["value","security"],["value","other"],["for","value"],["id","value","name","value",1,"form-control",3,"ngModelChange","ngModel","type"],[1,"form-actions"],["type","submit",1,"btn-save",3,"disabled"],["type","button",1,"btn-cancel",3,"click"],["type","button",1,"btn-delete"],["type","button",1,"btn-delete",3,"click"]],template:function(e,n){if(e&1){let s=x();r(0,"div",1)(1,"h2"),a(2),i(),r(3,"form",2,0),f("ngSubmit",function(){return u(s),g(n.onSubmit())}),r(5,"div",3)(6,"label",4),a(7,"Nom (Cl\xE9)"),i(),r(8,"input",5),O("ngModelChange",function(C){return u(s),w(n.setting.key,C)||(n.setting.key=C),g(C)}),i()(),r(9,"div",3)(10,"label",6),a(11,"\xC9tiquette"),i(),r(12,"input",7),O("ngModelChange",function(C){return u(s),w(n.setting.label,C)||(n.setting.label=C),g(C)}),i()(),r(13,"div",3)(14,"label",8),a(15,"Description"),i(),r(16,"input",9),O("ngModelChange",function(C){return u(s),w(n.setting.description,C)||(n.setting.description=C),g(C)}),i()(),r(17,"div",3)(18,"label",10),a(19,"Cat\xE9gorie"),i(),r(20,"select",11),O("ngModelChange",function(C){return u(s),w(n.setting.category,C)||(n.setting.category=C),g(C)}),r(21,"option",12),a(22,"Finance"),i(),r(23,"option",13),a(24,"S\xE9curit\xE9"),i(),r(25,"option",14),a(26,"Autre"),i()()(),r(27,"div",3)(28,"label",15),a(29,"Valeur"),i(),r(30,"input",16),O("ngModelChange",function(C){return u(s),w(n.setting.value,C)||(n.setting.value=C),g(C)}),i()(),r(31,"div",17)(32,"button",18),a(33,"Enregistrer"),i(),r(34,"button",19),f("click",function(){return u(s),g(n.onCancel())}),a(35,"Annuler"),i(),_(36,Rt,2,0,"button",20),i()()()}if(e&2){let s=ce(4);l(2),p(n.formTitle),l(6),M("ngModel",n.setting.key),m("disabled",n.setting.id!=null),l(4),M("ngModel",n.setting.label),l(4),M("ngModel",n.setting.description),l(4),M("ngModel",n.setting.category),l(10),M("ngModel",n.setting.value),m("type",n.isValueDate()?"date":"text"),l(2),m("disabled",!s.valid),l(4),h(n.setting.id?36:-1)}},dependencies:[y,te,W,ge,fe,B,ue,H,j,ee,X,Q],styles:[".settings-edit-form[_ngcontent-%COMP%]{padding:20px;border:1px solid #ddd;border-radius:5px;background-color:#fff}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f8f9fa;opacity:.7}.form-actions[_ngcontent-%COMP%]{margin-top:20px;display:flex;gap:10px}.btn-save[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer}.btn-save[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed}.btn-cancel[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer}"]})};var Se=class o{constructor(t){this.http=t}apiUrl=`${N.apiUrl}/admin/settings`;getHeaders(){let t=localStorage.getItem("token");if(!t)throw console.error("No token found"),new Error("No token found");return new F({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}getSettings(){return this.http.get(this.apiUrl,{headers:this.getHeaders()}).pipe(S(t=>(console.error("Error fetching settings:",t),E(()=>new Error("Failed to fetch settings: "+(t.error?.message||t.message))))))}addSetting(t){return this.http.post(this.apiUrl,t,{headers:this.getHeaders()}).pipe(S(e=>(console.error("Error adding setting:",e),E(()=>new Error("Failed to add setting: "+(e.error?.message||e.message))))))}updateSetting(t,e){return console.log("Sending update request for setting:",e),this.http.put(`${this.apiUrl}/${t}`,e,{headers:this.getHeaders()}).pipe(S(n=>(console.error("Error updating setting:",n),E(()=>new Error("Failed to update setting: "+(n.error?.message||n.message))))))}updateSettingByKey(t,e){return this.http.put(`${this.apiUrl}/by-key/${t}`,{value:e},{headers:this.getHeaders()}).pipe(S(n=>(console.error("Error updating setting by key:",n),E(()=>new Error("Failed to update setting by key: "+(n.error?.message||n.message))))))}deleteSetting(t){let e=`${this.apiUrl}/${t}`;return console.log("Sending DELETE request to:",e),this.http.delete(e,{headers:this.getHeaders()}).pipe(S(n=>(console.error("Error deleting setting:",n),E(()=>new Error("Failed to delete setting: "+(n.error?.message||n.message))))))}static \u0275fac=function(e){return new(e||o)(A(V))};static \u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})};var we=(o,t)=>t.id;function Ht(o,t){if(o&1){let e=x();r(0,"button",6),f("click",function(){u(e);let s=c();return g(s.addNewSetting())}),a(1,"+ Ajouter un param\xE8tre"),i()}}function jt(o,t){if(o&1){let e=x();r(0,"app-settings-edit-form",7),f("save",function(s){u(e);let d=c();return g(d.onSaveSetting(s))})("cancel",function(){u(e);let s=c();return g(s.cancelEdit())})("delete",function(s){u(e);let d=c();return g(d.deleteSetting(s))}),i()}if(o&2){let e=c();m("setting",e.selectedSetting)}}function Wt(o,t){o&1&&(r(0,"div",3),b(1,"span",8),a(2," Chargement... "),i())}function qt(o,t){if(o&1){let e=x();r(0,"div",4)(1,"span",9),a(2,"\u26A0\uFE0F"),i(),a(3),r(4,"button",10),f("click",function(){u(e);let s=c();return g(s.loadSettings())}),a(5,"R\xE9essayer"),i()()}if(o&2){let e=c();l(3),I(" ",e.error," ")}}function Ut(o,t){o&1&&(r(0,"p",11)(1,"span",13),a(2,"\u{1F4ED}"),i(),a(3," Aucun param\xE8tre disponible. "),i())}function $t(o,t){if(o&1){let e=x();r(0,"tr")(1,"td"),a(2),i(),r(3,"td"),a(4),i(),r(5,"td"),a(6),i(),r(7,"td")(8,"button",16),f("click",function(){let s=u(e).$implicit,d=c(3);return g(d.editSetting(s))}),a(9,"Modifier"),i(),r(10,"button",17),f("click",function(){let s,d=u(e).$implicit,C=c(3);return g(C.deleteSetting((s=d.id)!==null&&s!==void 0?s:-1))}),a(11,"Supprimer"),i()()()}if(o&2){let e=t.$implicit,n=c(3);l(2),p(e.label||e.key),l(2),p(n.formatValue(e.value)),l(2),p(e.description||"-"),l(4),m("disabled",!e.id)}}function zt(o,t){if(o&1){let e=x();r(0,"div",12)(1,"h3"),a(2,"Param\xE8tres li\xE9s \xE0 la Finance"),i(),r(3,"table")(4,"thead")(5,"tr")(6,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("finance","key"))}),a(7," Nom "),r(8,"span",15),a(9),i()(),r(10,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("finance","value"))}),a(11," Valeur "),r(12,"span",15),a(13),i()(),r(14,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("finance","description"))}),a(15," Description "),r(16,"span",15),a(17),i()(),r(18,"th"),a(19,"Action"),i()()(),r(20,"tbody"),Y(21,$t,12,4,"tr",null,we),i()()()}if(o&2){let e=c(2);l(9),p(e.getSortIcon("finance","key")),l(4),p(e.getSortIcon("finance","value")),l(4),p(e.getSortIcon("finance","description")),l(4),K(e.financeSettings)}}function Gt(o,t){if(o&1){let e=x();r(0,"tr")(1,"td"),a(2),i(),r(3,"td"),a(4),i(),r(5,"td"),a(6),i(),r(7,"td")(8,"button",16),f("click",function(){let s=u(e).$implicit,d=c(3);return g(d.editSetting(s))}),a(9,"Modifier"),i(),r(10,"button",17),f("click",function(){let s,d=u(e).$implicit,C=c(3);return g(C.deleteSetting((s=d.id)!==null&&s!==void 0?s:-1))}),a(11,"Supprimer"),i()()()}if(o&2){let e=t.$implicit,n=c(3);l(2),p(e.label||e.key),l(2),p(n.formatValue(e.value)),l(2),p(e.description||"-"),l(4),m("disabled",!e.id)}}function Yt(o,t){if(o&1){let e=x();r(0,"div",12)(1,"h3"),a(2,"Param\xE8tres li\xE9s \xE0 la S\xE9curit\xE9"),i(),r(3,"table")(4,"thead")(5,"tr")(6,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("security","key"))}),a(7," Nom "),r(8,"span",15),a(9),i()(),r(10,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("security","value"))}),a(11," Valeur "),r(12,"span",15),a(13),i()(),r(14,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("security","description"))}),a(15," Description "),r(16,"span",15),a(17),i()(),r(18,"th"),a(19,"Action"),i()()(),r(20,"tbody"),Y(21,Gt,12,4,"tr",null,we),i()()()}if(o&2){let e=c(2);l(9),p(e.getSortIcon("security","key")),l(4),p(e.getSortIcon("security","value")),l(4),p(e.getSortIcon("security","description")),l(4),K(e.securitySettings)}}function Kt(o,t){if(o&1){let e=x();r(0,"tr")(1,"td"),a(2),i(),r(3,"td"),a(4),i(),r(5,"td"),a(6),i(),r(7,"td")(8,"button",16),f("click",function(){let s=u(e).$implicit,d=c(3);return g(d.editSetting(s))}),a(9,"Modifier"),i(),r(10,"button",17),f("click",function(){let s,d=u(e).$implicit,C=c(3);return g(C.deleteSetting((s=d.id)!==null&&s!==void 0?s:-1))}),a(11,"Supprimer"),i()()()}if(o&2){let e=t.$implicit,n=c(3);l(2),p(e.label||e.key),l(2),p(n.formatValue(e.value)),l(2),p(e.description||"-"),l(4),m("disabled",!e.id)}}function Jt(o,t){if(o&1){let e=x();r(0,"div",12)(1,"h3"),a(2,"Autres Param\xE8tres"),i(),r(3,"table")(4,"thead")(5,"tr")(6,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("other","key"))}),a(7," Nom "),r(8,"span",15),a(9),i()(),r(10,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("other","value"))}),a(11," Valeur "),r(12,"span",15),a(13),i()(),r(14,"th",14),f("click",function(){u(e);let s=c(2);return g(s.sortSettings("other","description"))}),a(15," Description "),r(16,"span",15),a(17),i()(),r(18,"th"),a(19,"Action"),i()()(),r(20,"tbody"),Y(21,Kt,12,4,"tr",null,we),i()()()}if(o&2){let e=c(2);l(9),p(e.getSortIcon("other","key")),l(4),p(e.getSortIcon("other","value")),l(4),p(e.getSortIcon("other","description")),l(4),K(e.otherSettings)}}function Zt(o,t){if(o&1&&_(0,Ut,4,0,"p",11)(1,zt,23,3,"div",12)(2,Yt,23,3,"div",12)(3,Jt,23,3,"div",12),o&2){let e=c();h(e.settings.length?-1:0),l(),h(e.financeSettings.length?1:-1),l(),h(e.securitySettings.length?2:-1),l(),h(e.otherSettings.length?3:-1)}}function Qt(o,t){o&1&&(b(0,"span",8),a(1," Chargement... "))}function Xt(o,t){o&1&&a(0," Rafra\xEEchir ")}function en(o,t){if(o&1){let e=x();r(0,"button",18),f("click",function(){u(e);let s=c();return g(s.loadSettings())}),_(1,Qt,2,0)(2,Xt,1,0),i()}if(o&2){let e=c();m("disabled",e.loading),l(),h(e.loading?1:2)}}var ae=class o{constructor(t){this.settingsService=t}settings=[];financeSettings=[];securitySettings=[];otherSettings=[];selectedSetting=null;isEditMode=!1;loading=!0;error=null;sortState={finance:{field:"",direction:null},security:{field:"",direction:null},other:{field:"",direction:null}};ngOnInit(){this.loadSettings()}loadSettings(){this.loading=!0,this.error=null,this.settingsService.getSettings().subscribe({next:t=>{console.log("Settings loaded:",t),this.settings=t||[],this.classifySettings(),this.loading=!1},error:t=>{this.error=t.message||"Erreur lors du chargement des param\xE8tres. V\xE9rifiez votre connexion ou contactez l'administrateur.",this.loading=!1,console.error("Error loading settings:",t)}})}classifySettings(){this.financeSettings=this.settings.filter(t=>t.category?.toLowerCase()==="finance"),this.securitySettings=this.settings.filter(t=>t.category?.toLowerCase()==="security"),this.otherSettings=this.settings.filter(t=>!t.category||t.category.toLowerCase()!=="finance"&&t.category.toLowerCase()!=="security"),this.sortCategory("finance"),this.sortCategory("security"),this.sortCategory("other")}sortSettings(t,e){let n=this.sortState[t];n.field===e&&n.direction==="asc"?n.direction="desc":n.field===e&&n.direction==="desc"?n.direction=null:(n.field=e,n.direction="asc"),this.sortCategory(t)}sortCategory(t){let e=this.sortState[t],n;t==="finance"?n=this.financeSettings:t==="security"?n=this.securitySettings:n=this.otherSettings,e.direction&&n.sort((s,d)=>{let C=s[e.field],q=d[e.field];return e.field==="value"&&(C=this.formatValue(C),q=this.formatValue(q)),C==null&&(C=""),q==null&&(q=""),e.direction==="asc"?String(C).localeCompare(String(q)):String(q).localeCompare(String(C))})}getSortIcon(t,e){let n=this.sortState[t];return n.field!==e||!n.direction?"\u2195\uFE0F":n.direction==="asc"?"\u2191":"\u2193"}addNewSetting(){this.selectedSetting={key:"",value:"",category:"other",label:"",description:""},this.isEditMode=!0}editSetting(t){this.selectedSetting=D({},t),this.isEditMode=!0}onSaveSetting(t){t.id!==void 0&&t.id!==null?this.settingsService.updateSetting(t.id,t).subscribe({next:e=>{let n=this.settings.findIndex(s=>s.id===e.id);n!==-1&&(this.settings[n]=e,this.classifySettings()),this.cancelEdit()},error:e=>{let n="Erreur lors de la mise \xE0 jour du param\xE8tre.";e.status===0?n+=" Probl\xE8me de connexion au serveur. V\xE9rifiez que le serveur est en cours d'ex\xE9cution.":e.status&&(n+=` Code: ${e.status}. ${e.message||"Erreur inconnue."}`),this.error=n,console.error("Error updating setting:",e)}}):this.settingsService.addSetting(t).subscribe({next:e=>{this.settings=[...this.settings,e],this.classifySettings(),this.cancelEdit()},error:e=>{let n="Erreur lors de l'ajout du param\xE8tre.";e.status===0?n+=" Probl\xE8me de connexion au serveur. V\xE9rifiez que le serveur est en cours d'ex\xE9cution.":e.status&&(n+=` Code: ${e.status}. ${e.message||"Erreur inconnue."}`),this.error=n,console.error("Error adding setting:",e)}})}deleteSetting(t){if(t==null){console.warn("Cannot delete setting: ID is undefined or null");return}confirm("\xCAtes-vous s\xFBr de vouloir supprimer ce param\xE8tre ?")&&this.settingsService.deleteSetting(t).subscribe({next:()=>{this.settings=this.settings.filter(e=>e.id!==t),this.classifySettings(),this.selectedSetting?.id===t&&this.cancelEdit()},error:e=>{let n="Erreur lors de la suppression du param\xE8tre.";e.status===0?n+=" Probl\xE8me de connexion au serveur. V\xE9rifiez que le serveur est en cours d'ex\xE9cution.":e.status&&(n+=` Code: ${e.status}. ${e.message||"Erreur inconnue."}`),this.error=n,console.error("Error deleting setting:",e)}})}cancelEdit(){this.selectedSetting=null,this.isEditMode=!1}formatValue(t){if(t==null)return"-";if(typeof t=="boolean")return t?"Oui":"Non";if(t instanceof Date&&!isNaN(t.getTime()))return t.toLocaleDateString("fr-FR");if(typeof t=="number"||typeof t=="string"&&!isNaN(Number(t))&&t.trim()!=="")return String(t);if(typeof t=="object")try{return JSON.stringify(t)}catch{return"[Objet complexe]"}return String(t)}static \u0275fac=function(e){return new(e||o)(T(Se))};static \u0275cmp=v({type:o,selectors:[["app-settings-list"]],decls:9,vars:4,consts:[[1,"settings-list"],[1,"btn-add"],[3,"setting"],[1,"loading"],[1,"error"],[1,"btn-refresh",3,"disabled"],[1,"btn-add",3,"click"],[3,"save","cancel","delete","setting"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"empty-state"],[1,"settings-section"],[1,"empty-icon"],[3,"click"],[1,"sort-icon"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click","disabled"],[1,"btn-refresh",3,"click","disabled"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Param\xE8tres G\xE9n\xE9raux"),i(),_(3,Ht,2,0,"button",1)(4,jt,1,1,"app-settings-edit-form",2)(5,Wt,3,0,"div",3)(6,qt,6,1,"div",4)(7,Zt,4,4)(8,en,3,2,"button",5),i()),e&2&&(l(3),h(n.isEditMode?-1:3),l(),h(n.isEditMode&&n.selectedSetting?4:-1),l(),h(n.loading?5:n.error?6:7),l(3),h(n.isEditMode?-1:8))},dependencies:[y,G],styles:[".settings-list[_ngcontent-%COMP%]{padding:20px}.settings-section[_ngcontent-%COMP%]{margin-bottom:30px}.settings-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:10px;color:#333}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;box-shadow:0 1px 3px #0003}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#f4f4f4;cursor:pointer}th[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.sort-icon[_ngcontent-%COMP%]{margin-left:5px}.btn-edit[_ngcontent-%COMP%]{padding:5px 10px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn-delete[_ngcontent-%COMP%]{padding:5px 10px;background-color:#dc3545;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#c82333}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:15px;text-align:center}.loading[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;animation:spin 1s linear infinite}.error[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.error[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{margin-right:5px;vertical-align:middle}.error[_ngcontent-%COMP%]   .btn-retry[_ngcontent-%COMP%]{margin-left:10px;padding:5px 10px;background-color:#c62828;color:#fff;border:none;border-radius:4px;cursor:pointer}.empty-state[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#666}.btn-add[_ngcontent-%COMP%]{padding:8px 16px;background-color:#28a745;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-bottom:10px}.btn-refresh[_ngcontent-%COMP%]{padding:8px 16px;background-color:#6c757d;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-refresh[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}@media (max-width: 768px){table[_ngcontent-%COMP%]{display:block;overflow-x:auto}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{min-width:150px}.btn-add[_ngcontent-%COMP%], .btn-refresh[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}}"]})};var ve=class o{constructor(t){this.http=t}apiUrl=`${N.apiUrl}/admin/employees`;getHeaders(){let t=localStorage.getItem("token");if(!t)throw console.error("No token found"),new Error("No token found");return new F({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}createEmployee(t){return this.http.post(this.apiUrl,t,{headers:this.getHeaders()}).pipe(S(e=>{console.error("Error creating employee:",e);let n=e.error?.error||e.error?.message||"Failed to create employee";return E(()=>new Error(n))}))}static \u0275fac=function(e){return new(e||o)(A(V))};static \u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})};function nn(o,t){o&1&&(r(0,"mat-error"),a(1,"First name is required"),i())}function rn(o,t){o&1&&(r(0,"mat-error"),a(1,"Last name is required"),i())}function on(o,t){o&1&&(r(0,"mat-error"),a(1,"Phone number is required"),i())}function an(o,t){o&1&&(r(0,"mat-error"),a(1,"Email Personnel is required"),i())}function sn(o,t){o&1&&(r(0,"mat-error"),a(1,"cin is required"),i())}function ln(o,t){if(o&1&&(r(0,"p",12),a(1),i()),o&2){let e=c();l(),p(e.successMessage)}}function cn(o,t){if(o&1&&(r(0,"p",13),a(1),i()),o&2){let e=c();l(),p(e.errorMessage)}}var se=class o{constructor(t,e){this.employeeService=t;this.router=e}employee={firstName:"",lastName:"",phoneNumber:"",cin:"",emailPersonnel:""};successMessage="";errorMessage="";isLoading=!1;onSubmit(){if(!this.employee.firstName||!this.employee.lastName||!this.employee.phoneNumber||!this.employee.cin||!this.employee.emailPersonnel){this.errorMessage="All fields are required.";return}this.isLoading=!0,this.errorMessage="",this.successMessage="",this.employeeService.createEmployee(this.employee).subscribe({next:t=>{this.isLoading=!1,this.successMessage=`Employee created successfully! Identifiant: ${t.username}. `,this.employee={firstName:"",lastName:"",phoneNumber:"",cin:"",emailPersonnel:""}},error:t=>{this.isLoading=!1,this.errorMessage=t.message||"Failed to create employee.",console.error("Error creating employee:",t)}})}cancel(){this.router.navigate(["/admin/dashboard"])}static \u0275fac=function(e){return new(e||o)(T(ve),T(Le))};static \u0275cmp=v({type:o,selectors:[["app-add-employee"]],decls:38,vars:15,consts:[[3,"ngSubmit"],["appearance","fill"],["matInput","","name","firstName","required","",3,"ngModelChange","ngModel"],[4,"ngIf"],["matInput","","name","lastName","required","",3,"ngModelChange","ngModel"],["matInput","","name","phoneNumber","required","",3,"ngModelChange","ngModel"],["matInput","","name","emailPersonnel","required","",3,"ngModelChange","ngModel"],["matInput","","name","cin","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","warn","type","button",3,"click","disabled"],["style","color: green;",4,"ngIf"],["style","color: red;",4,"ngIf"],[2,"color","green"],[2,"color","red"]],template:function(e,n){e&1&&(r(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),a(3,"Add New Employee"),i()(),r(4,"mat-card-content")(5,"form",0),f("ngSubmit",function(){return n.onSubmit()}),r(6,"mat-form-field",1)(7,"mat-label"),a(8,"First Name"),i(),r(9,"input",2),O("ngModelChange",function(d){return w(n.employee.firstName,d)||(n.employee.firstName=d),d}),i(),_(10,nn,2,0,"mat-error",3),i(),r(11,"mat-form-field",1)(12,"mat-label"),a(13,"Last Name"),i(),r(14,"input",4),O("ngModelChange",function(d){return w(n.employee.lastName,d)||(n.employee.lastName=d),d}),i(),_(15,rn,2,0,"mat-error",3),i(),r(16,"mat-form-field",1)(17,"mat-label"),a(18,"Phone Number"),i(),r(19,"input",5),O("ngModelChange",function(d){return w(n.employee.phoneNumber,d)||(n.employee.phoneNumber=d),d}),i(),_(20,on,2,0,"mat-error",3),i(),r(21,"mat-form-field",1)(22,"mat-label"),a(23,"Personal Email"),i(),r(24,"input",6),O("ngModelChange",function(d){return w(n.employee.emailPersonnel,d)||(n.employee.emailPersonnel=d),d}),i(),_(25,an,2,0,"mat-error",3),i(),r(26,"mat-form-field",1)(27,"mat-label"),a(28,"Cin"),i(),r(29,"input",7),O("ngModelChange",function(d){return w(n.employee.cin,d)||(n.employee.cin=d),d}),i(),_(30,sn,2,0,"mat-error",3),i(),r(31,"div")(32,"button",8),a(33),i(),r(34,"button",9),f("click",function(){return n.cancel()}),a(35,"Cancel"),i()()(),_(36,ln,2,1,"p",10)(37,cn,2,1,"p",11),i()()),e&2&&(l(9),M("ngModel",n.employee.firstName),l(),m("ngIf",!n.employee.firstName),l(4),M("ngModel",n.employee.lastName),l(),m("ngIf",!n.employee.lastName),l(4),M("ngModel",n.employee.phoneNumber),l(),m("ngIf",!n.employee.phoneNumber),l(4),M("ngModel",n.employee.emailPersonnel),l(),m("ngIf",!n.employee.emailPersonnel),l(4),M("ngModel",n.employee.cin),l(),m("ngIf",!n.employee.cin),l(2),m("disabled",n.isLoading),l(),I(" ",n.isLoading?"Creating...":"Create Employee"," "),l(),m("disabled",n.isLoading),l(2),m("ngIf",n.successMessage),l(),m("ngIf",n.errorMessage))},dependencies:[y,Z,te,W,B,H,j,ee,X,Q,Je,ze,Ye,Ke,Ge,et,Xe,Ze,Qe,nt,tt,Be,Re],styles:["mat-card[_ngcontent-%COMP%]{max-width:400px;margin:2em auto;padding:1em}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1em}button[_ngcontent-%COMP%]{margin-right:1em}"]})};var dn=[{path:"",component:ie,children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:re},{path:"currencies",component:oe},{path:"currencies/edit/:id",component:z},{path:"settings",component:ae},{path:"settings/edit/:id",component:G},{path:"create-employee",component:se}]}],rt=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=Ie({type:o});static \u0275inj=Oe({imports:[y,me.forChild(dn),ie,re,oe,ae,z,G,se]})};export{rt as AdminModule};
